#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# è¿è¡Œä»£ç æ ¼å¼åŒ–æ£€æŸ¥
echo "ğŸ“ Checking code formatting..."
npm run lint -- --quiet

if [ $? -ne 0 ]; then
  echo "âŒ ESLint found issues. Run 'npm run lint -- --fix' to fix them."
  exit 1
fi

echo "âœ… Code formatting check passed"

# è¿è¡ŒTypeScriptç±»å‹æ£€æŸ¥
echo "ğŸ”§ Checking TypeScript types..."
npx tsc --noEmit --skipLibCheck

if [ $? -ne 0 ]; then
  echo "âŒ TypeScript compilation failed"
  exit 1
fi

echo "âœ… TypeScript check passed"

# æ„å»ºæ’ä»¶
echo "ğŸ—ï¸ Building plugin..."
npm run build

if [ $? -ne 0 ]; then
  echo "âŒ Build failed"
  exit 1
fi

echo "âœ… Build successful"

echo "ğŸ‰ All pre-commit checks passed!"